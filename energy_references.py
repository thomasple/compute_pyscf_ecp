""" 
reference energies for FeNNix-Bio1
* DFT functional: wB97M-D3BJ / aug-ccpVTZ / ccECP
* all energies in Hartree units
"""
import numpy as np
from utils import PERIODIC_TABLE_REV_IDX,PERIODIC_TABLE

# isolated atom energies for a few charges
isolated_atom_energies = {
  'B': {-2: -2.4559415962284588, -1: -2.618234068615187, 0: -2.5965821318210525, 1: -2.2680586038909367},
  'Br': {-2: -13.219229318317721, -1: -13.442684626862327, 0: -13.311295158111124, 1: -12.87293858914298, 2: -12.089014850739678},
  'C': {-1: -5.469757167828115, 0: -5.414825653002762, 1: -4.982941476230329},
  'Ca': {-1: -36.664495476603776, 0: -36.665142851050916, 1: -36.43717320934047, 2: -36.0033474743082},
  'Cl': {-1: -182.35750567096198, 0: -182.22103663053923, 1: -181.74020591763525},
  'F': {-1: -24.309613221977482, 0: -24.188510280257546, 1: -23.54973664917081},
  'H': {-1: -0.5312576444949981, 0: -0.49882344722698513, 1: 0},
  'I': {-1: -11.522832300346952, 0: -11.399356492570126, 1: -11.009428245722836},
  'K': {-1: -28.213108008189707, 0: -28.193774542068642, 1: -28.035162600556493},
  'Li': {-1: -7.507599332143119, 0: -7.486658460318699, 1: -7.286181075467054},
  'Mg': {-1: -63.27319402705373, 0: -63.2912482338778, 1: -63.006966716061214, 2: -62.44905591698561},
  'N': {-1: -9.74876048940488, 0: -9.774765766929455, 1: -9.227336822568605},
  'Na': {-1: -47.6899377388321, 0: -47.67134200369481, 1: -47.47876394198665},
  'O': {-2: -15.671546927586698, -1: -15.927420776420258, 0: -15.876853149805676, 1: -15.392459592778721, 2: -14.089227197627576},
  'P': {-3: -125.32483615996767, -2: -125.60362696545252, -1: -125.75628665302224, 0: -125.72389102372158, 1: -125.34267626134704, 2: -124.62268851691819, 3: -123.52307735615568},
  'S': {-2: -152.38836635839607, -1: -152.5374296697188, 0: -152.45631990821738, 1: -152.07003284523032, 2: -151.2179107609722, 3: -149.9455065316571, 4: -148.21696544363493}, 
  'Si': {-2: -101.9543110319909, -1: -102.10800389031276, 0: -102.05752582189783, 1: -101.76245540252077},
  'Zn': {-2: -226.19355393260784, -1: -226.32208065533135, 0: -226.34501283554292, 1: -225.99682636110433, 2: -225.33335751442087}
}

# isolated neutral atom energies to compute formation energy (E_formation = E_DFT - SUM_i E0_Z[i]) 
# neutral_atom_energies = np.array([ 0.000000, -0.498823, 0.000000, -7.486658, 0.000000, -2.596582, -5.414826, -9.774766, -15.876853, -24.188510, 0.000000, -47.671342, -63.291248, 0.000000, -102.057526, -125.723891, -152.456320, -182.221037, 0.000000, -28.193775, -36.665143, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -226.345013, 0.000000, 0.000000, 0.000000, 0.000000, -13.311295, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -11.399356, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 ])

neutral_atom_energies = np.zeros(len(PERIODIC_TABLE))
for elem, energies in isolated_atom_energies.items():
    Z = PERIODIC_TABLE_REV_IDX[elem]
    neutral_atom_energies[Z] = energies[0]

# atomic energy shift from formation energy to shifted energy (E_shifted = E_formation - SUM_i DeltaEf_Z[i]) obtained by minimizing E_shifted^2 over the bio1M dataset
delta_eform_bio1M=np.array([ 0.000000, -0.099695, -0.000000, -0.038666, -0.000000, -0.374328, -0.253681, -0.089409, -0.140600, -0.122984, -0.000000, 0.046815, 0.328745, 0.000000, -0.238450, -0.097987, -0.112028, -0.072498, 0.000000, 0.020120, 0.279375, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.119177, 0.000000, 0.000000, 0.000000, 0.000000, -0.061215, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.058393, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 ])

E_ref_bio1M = neutral_atom_energies+delta_eform_bio1M


# atomic energy shift from formation energy to shifted energy (E_shifted = E_formation - SUM_i DeltaEf_Z[i]) obtained by minimizing E_shifted^2 over the bio1S dataset
delta_eform_bio1S=np.array([ 0.000000, -0.099941, 0.000000, -0.032044, 0.000000, -0.372171, -0.253010, -0.091168, -0.140318, -0.122306, 0.000000, 0.040241, 0.348279, 0.000000, -0.236559, -0.103901, -0.112605, -0.075724, 0.000000, 0.018455, 0.253501, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.116177, 0.000000, 0.000000, 0.000000, 0.000000, -0.060074, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.047454, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 ])

E_ref_bio1S = neutral_atom_energies+delta_eform_bio1S
